students<-randomNames(n.students, gender=sample(0:1, n.students, replace=T), ethnicity=sample(2:5, n.students, replace=T), which.names="both", name.order="first.last", name.sep=" ")
major<-sample(c("Forestry", "Forest Business", "Wildlife", 'Fisheries', 'NRRT'), size=n.students, prob=c(.2,.25,.25,.2,.1), replace=T)
degree<-vector()
for(i in 1:length(major)){
if(major[i]=="Forest Business"){
degree[i]<-c("MFR")
}
if(major[i]!="Forest Business"){
degree[i]<-sample(c("MS", "PhD", "MNR"), size=n.students-length(major[major=="Forest Business"]),prob=c(.6,.3,.1), replace=T)
}
}
ego.df<-data.frame(cbind(students, major, degree))
ego<-ego.df$students
max_connections = 7
alter.test.df<-data.frame()
for(i in 1:length(ego)){
ego.df.rm <- ego[!ego == ego[i]]
alter.i <- sample(ego.df.rm,sample(1:max_connections,1),replace = FALSE)
alter.df.i <- cbind(rep(ego[i],length(alter.i)),alter.i)
alter.test.df <- rbind(alter.test.df,alter.df.i)
}
alter.test.df
str(alter.test.df)
names(alter.test.df)<-c("ego","alter")
later.test.df
alter.test.df
ego<-ego.df$students
max_connections = 7
alter.test.df<-data.frame()
for(i in 1:length(ego)){
ego.df.rm <- ego[!ego == ego[i]]
alter.i <- sample(ego.df.rm,sample(1:max_connections,1),replace = FALSE)
alter.df.i <- cbind(rep(ego[i],length(alter.i)),alter.i)
alter.test.df <- rbind(alter.test.df,alter.df.i)
}
dog.df.rm
ego.df.rm
alter.i
later.df.i
alter.df.i
ego<-as.vector(ego.df$students)
ego
ego[!ego == ego[i]]
for(i in 1:length(ego)){
ego.df.rm <- ego[!ego == ego[i]]
alter.i <- sample(ego.df.rm,sample(1:max_connections,1),replace = FALSE)
alter.df.i <- cbind(rep(ego[i],length(alter.i)),alter.i)
alter.test.df <- rbind(alter.test.df,alter.df.i)
}
alter.test.df
names(alter.test.df)<-c("ego","alter")
n.edge.indiv <- length(alter.test.df$alter)
graph_complete <- graph.data.frame(d = edge.df, vertices = alter.test.df)
graph_complete <- graph.data.frame(d = alter.test.df, vertices = ego.df)
n.students<-50
students<-randomNames(n.students, gender=sample(0:1, n.students, replace=T), ethnicity=sample(2:5, n.students, replace=T), which.names="both", name.order="first.last", name.sep=" ")
major<-sample(c("Forestry", "Forest Business", "Wildlife", 'Fisheries', 'NRRT'), size=n.students, prob=c(.2,.25,.25,.2,.1), replace=T)
degree<-vector()
for(i in 1:length(major)){
if(major[i]=="Forest Business"){
degree[i]<-c("MFR")
}
if(major[i]!="Forest Business"){
degree[i]<-sample(c("MS", "PhD", "MNR"), size=n.students-length(major[major=="Forest Business"]),prob=c(.6,.3,.1), replace=T)
}
}
ego.df<-data.frame(cbind(students, major, degree))
ego<-as.vector(ego.df$students)
max_connections = 7
alter.test.df<-data.frame()
for(i in 1:length(ego)){
ego.df.rm <- ego[!ego == ego[i]]
alter.i <- sample(ego.df.rm,sample(1:max_connections,1),replace = FALSE)
alter.df.i <- cbind(rep(ego[i],length(alter.i)),alter.i)
alter.test.df <- rbind(alter.test.df,alter.df.i)
}
str(alter.test.df)
names(alter.test.df)<-c("ego","alter")
n.edge.indiv <- length(alter.test.df$alter)
graph_complete <- graph.data.frame(d = alter.test.df, vertices = ego.df)
summary(graph_complete)
V(graph_complete)$degree
V(graph)$major
graph<- graph.data.frame(d = alter.test.df, vertices = ego.df)
summary(graph)
V(graph)$degree
V(graph)$students
V(graph)$major
plot(graph,
#edge.color=edge_test$connection,
edge.arrow.size=.1,
#vertex.color=profession.colors,
#vertex.size=((in.degree)*1.5),
vertex.size=5,
vertex.label=NA,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="Network Plot_Nicely",
#frame=TRUE,
margin=0.0001,
layout = layout_nicely)
layout.graph <- layout_(graph, nicely())
layout.graph<-norm_coords(layout.graph, ymin=-1, ymax=1, xmin=-1, xmax=1)
colr.palette <- brewer.pal(n = length(major), name = "Spectral") # picking color palette to graph with
colr.palette <- brewer.pal(n = length(sort(unique(major))), name = "Spectral") # picking color palette to graph with
profession.colors <- colr.palette[ego.df$major] # Assigning colors to majors
major.colors <- colr.palette[ego.df$major] # Assigning colors to majors
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
major.list<-sort(unique(major))
layout.graph <- layout_(graph, nicely())
layout.graph<-norm_coords(layout.graph, ymin=-1, ymax=1, xmin=-1, xmax=1)
colr.palette <- brewer.pal(n = length(major.list), name = "Spectral") # picking color palette to graph with
major.colors <- colr.palette[ego.df$major] # Assigning colors to majors
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
colr.palette <- brewer.pal(n = length(major.list), name = "rainbow") # picking color palette to graph with
colr.palette <- brewer.pal(n = length(major.list), name = "Rainbow") # picking color palette to graph with
colr.palette <- brewer.pal(n = length(major.list), name = "Pastel2") # picking color palette to graph with
major.colors <- colr.palette[ego.df$major] # Assigning colors to majors
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
colr.palette <- brewer.pal(n = length(major.list), name = "Accent") # picking color palette to graph with
major.colors <- colr.palette[ego.df$major] # Assigning colors to majors
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
vertex.label=V(graph)$major,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
vertex.label=V(graph)$major,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, legend = major.list,
col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=profession.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, professions, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
legend(x=-1, y = -1, major, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=profession.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, major, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
legend(x=-1, y = -1, major.list, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=profession.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, major.list, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, major.list, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
plot(graph,
layout = layout_with_fr,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_dh,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_dh,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_fr,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_sugiyama,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_sugiyama,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_with_drl,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_on_sphere,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_in_circle,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_in_circle,
edge.arrow.size=.1,
vertex.shapes="none"
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_in_circle,
edge.arrow.size=.1,
vertex.shapes="none",
vertex.color=major.colors,
vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_in_circle,
edge.arrow.size=.1,
vertex.shapes="none",
#vertex.color=major.colors,
#vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
plot(graph,
layout = layout_in_circle,
edge.arrow.size=.1,
vertex.shape="none",
#vertex.color=major.colors,
#vertex.size=5,
#vertex.label=V(graph)$major,
vertex.label=V(graph)$student,
vertex.label.cex=0.7,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA by Profession",
#frame=TRUE,
margin = 0.0001)
cluster_label_prop(graph)
clp<-cluster_label_prop(graph)
plot(clp, graph)
clp<-cluster_fast_greedy(as.undirected(graph))
plot(clp, graph)
n.edge.indiv
conn.type<-sample(c("Classes", "Social"), n=n.edge.indiv, prob=c(0.6, 0.4), replace=T)
conn.type<-sample(c("Classes", "Social"), size=n.edge.indiv, prob=c(0.6, 0.4), replace=T)
conn.type
alter.test.df
alter.test.df<-cbind(alter.test.df, conn.type)
head(alter.test.df)
graph<- graph.data.frame(d = alter.test.df, vertices = ego.df)
summary(graph)
V(graph)$degree
V(graph)$students
V(graph)$major
E(graph)$conn.type
E(graph)$conn.type=="Class"
E(graph)$conn.type=="Classes"
ifelse(E(graph)$conn.type=="Classes", "red", "blue"))
plot(graph,
edge.color=ifelse(E(graph)$conn.type=="Classes", "red", "blue"),
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
legend(x=-1, y = -1, major.list, pch=19,
col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
diameter<-diameter(graph)
diameter
reciprocity<-reciprocity(graph)
reciprocity
edge.count <- ecount(graph)
vertex.count <- vcount(graph)
closeness<-closeness(graph)
closeness<-closeness(as.data.frame(graph))
closeness<-closeness(graph)
closeness<-igraph::closeness(graph)
degree<-igraph::degree(graph)
degree
plot(graph,
edge.color=ifelse(E(graph)$conn.type=="Classes", "red", "blue"),
layout = layout.graph,
rescale = F,
edge.arrow.size=.1,
vertex.color=major.colors,
vertex.size=igraph::degree(graph),
vertex.label=NA,
vertex.label.cex=0.5,
vertex.label.dist=1,
vertex.label.degree=-0.6,
main="SNA Vertices Weighted by Degree",
#frame=TRUE,
margin = 0.0001)
