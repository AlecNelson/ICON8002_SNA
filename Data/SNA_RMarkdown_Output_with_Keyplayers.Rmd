---
title: "ICON8002 SNA"
date: '`r format(Sys.time())`'
author: ICON 2017 Cohort
geometry: margin=0.7cm
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
```

# Social Network Analysis
This is a report generated from social network analysis of the actors within the shrimping industry on the Georgia Coast. The resulting output of the analysis demonstrates the relationships between shrimpers, dockers, and other agencies/organizations. 


## Network attributes

* Diameter

    The network has a diameter of $`r Diameter_stat_complete`$. This measure is the length of the longest geodesic (the largest distance between any two vertices in a connected graph).

* Reciprocity

    The network has a reciprocity of $`r Reciprocity_stat_complete`$. The measure of reciprocity defines the proportion of mutual connections, in a directed graph.

* Number of edges

    The network has $`r ecount_stat_complete`$ total edges.

* Number of egos

    The network has $`r vcount_stat_complete`$ total egos

* Edge density

    The network has a density of $`r Density_stat_complete`$. This measure is the ratio of the number of edges and the number of possible edges.

* Transitivity

    The network has a transitivity of $`r Transitivity_stat_complete`$. This measure is the probability that the adjacent vertices of a vertex are connected. This is sometimes also called the clustering coefficient.

## Vertex attributes

* Closeness

    The vertex with the greatest closeness is $`r as.character(vertex_df$ego[Closeness_max_stat_indiv])`$ (closeness of $`r Closeness_max_stat_indiv`$). This measures how many steps is required to access every other vertex from a given vertex.

    The vertex with the least closeness is $`r as.character(vertex_df$ego[Closeness_min_stat_indiv])`$ (closeness of $`r Closeness_min_stat_indiv`$). This measures how many steps is required to access every other vertex from a given vertex.

* Degree

    The vertex with the greatest degree is $`r as.character(vertex_df$ego[Degree_max_stat_indiv])`$ (degree of $`r as.numeric(igraph::degree(soc.network)[Degree_max_stat_indiv])`$). This measure is the number of its adjacent edges.

    The vertex with the fewest degree is $`r as.character(vertex_df$ego[Degree_min_stat_indiv])`$ (degree of $`r as.numeric(igraph::degree(soc.network)[Degree_min_stat_indiv])`$). This measure is the number of its adjacent edges.




## Network plots


```{r fig.width=10, fig.height=10, fig.cap=paste("Original social network plot with no alterations (Nicely layout)")}
  plot(soc.network,
       layout = layout.graph,
       edge.arrow.size=.5,
       edge.color="Gray60",
       vertex.size=5,
       vertex.label=NA,
       vertex.label.cex=0.7,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="Network Plot_Nicely",
       margin=0.0001)
```

```{r fig.width=8, fig.height=8, fig.cap=paste("Social network plot with vertex colored based on profession (Nicely layout)")}
plot(soc.network,
       layout = layout.graph,
       rescale = F,
       edge.arrow.size=.5,
       vertex.color=profession.colors,
       vertex.label=NA,
       vertex.size=5,
       vertex.label.cex=0.5,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="SNA by Profession",
       margin = 0.0001)

  legend(x=-1, y = -1, legend = professions,
         col = colr.palette, pch=19, pt.cex=1, cex=1, bty="n", ncol=2)
```




```{r fig.width=8, fig.height=8, fig.cap=paste("Social network plot with vertex colored based on profession and vertices weighed by total degree")}
  plot(soc.network,
       layout = layout.graph,
       rescale = F,
       edge.arrow.size=.5,
       vertex.color=profession.colors,
       vertex.size=igraph::degree(soc.network),
       vertex.label=NA,
       vertex.label.cex=0.5,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="SNA Vertices Weighted by Degree",
       margin = 0.0001)
  legend(x=-1.1, y = -1.1, professions, pch=19,
         col= colr.palette, pt.cex=1, cex=1, bty="n", ncol=2)
```
  
```{r fig.width=8, fig.height=8, fig.cap=paste("Social network plot demonstrating how long vertices have worked with each other")}
  plot(graph.years.wk,
       layout=(layout.graph*1.1),
       rescale=F,
       edge.arrow.size=.5,
       vertex.color=profession.colors,
       vertex.size=3,
       vertex.label=NA,
       vertex.label.cex=0.6,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       main=paste0('Network of worked-together-with ',cut.off,' years connection'),
       margin=0.0001)
  legend(x=-1.1, y = -1.1, professions, pch=19,
         col= colr.palette, pt.cex=1, cex=1, bty="n", ncol=2)
```

```{r fig.width=8, fig.height=8, fig.cap=paste("Social network plot with vertices grouped by profession")}
  plot(soc.network,
       layout=(LO*1.0),
       rescale=F, 
       edge.arrow.size=.5,
       vertex.color=profession.colors,
       vertex.size=3,
       vertex.label=NA,
       vertex.label.cex=0.7,
       vertex.label.color= adjustcolor("black", 0.6),
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main='Network Plot Professions Grouped',
       margin=0.01)
  legend(x=-1.1, y = -1.1, professions, pch=19,
         col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
  ```
## Keyplayers

```{r results='asis'}

kable(Keyplayer_df)
```

```{r fig.width=8, fig.height=8, fig.cap=paste("Social network plot with keyplayers highlighted based on vertex attributes")}
   plot(soc.network,
        layout=layout.graph,
        rescale=T,
        edge.color="Gray80",
        edge.arrow.size=.5,
        vertex.color=ego_col,
        vertex.size=ifelse((igraph::get.vertex.attribute(soc.network)$name %in% Keyplayer_names), 8, 4),
        vertex.label= ifelse((igraph::get.vertex.attribute(soc.network)$name %in% Keyplayer_names), as.character(igraph::get.vertex.attribute(soc.network)$name), NA),
        vertex.label.color = "blue",
        vertex.label=NA,
        vertex.label.cex=ifelse(vertex_df$ego == as.character(vertex_df$ego[177]), .4, NA),
        vertex.label.dist=4,
        vertex.label.degree=0,
        main='Network with highlighted Key Players',
        margin=0.0001)
   
   legend(x=-1, y = -1, c("Closeness","Betweenness","Degree","Eigenvector","Overlap"), pch=19,
          col= c("blue", "green", "red","yellow","purple"), pt.cex=1.5, cex=0.8, bty="n", ncol=1)
```