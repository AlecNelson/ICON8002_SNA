---
title: "ICON8002 SNA"
date: '`r format(Sys.Date())`'
author: ICON 2017 Cohort
geometry: margin=0.7cm
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=25, fig.height=25, echo = F)
```

# Social Network Analysis
This is a report generated from social network analysis of the actors within the shrimping industry on the Georgia Coast. The resulting output of the analysis demonstrates the relationships between shrimpers, dockers, and other agencies/organizations. 


## Network attributes

* Diameter

The network has a diameter of $`r Diameter_stat_complete`$. This measure is the length of the longest geodesic (the largest distance between any two vertices in a connected graph).

* Reciprocity

The network has a reciprocity of $`r Reciprocity_stat_complete`$. The measure of reciprocity defines the proportion of mutual connections, in a directed graph.

* Number of edges
The network has $`r ecount_stat_complete`$ total edges.

* Number of egos
The network has $`r vcount_stat_complete`$ total egos

* Edge density

The network has a density of $`r Density_stat_complete`$. This measure is the ratio of the number of edges and the number of possible edges.

* Transitivity

The network has a transitivity of $`r Transitivity_stat_complete`$. This measure is the probability that the adjacent vertices of a vertex are connected. This is sometimes also called the clustering coefficient.

## Vertex attributes

* Closeness

The vertex with the greatest closeness is $`r as.character(vertex_df$ego[Closeness_max_stat_indiv])`$ (number: $`r Closeness_max_stat_indiv`$). This measures how many steps is required to access every other vertex from a given vertex.

The vertex with the least closeness is $`r as.character(vertex_df$ego[Closeness_min_stat_indiv])`$ (number: $`r Closeness_min_stat_indiv`$). This measures how many steps is required to access every other vertex from a given vertex.

* Degree

The vertex with the greatest degree is $`r as.character(vertex_df$ego[Degree_max_stat_indiv])`$ (number: $`r Degree_max_stat_indiv`$). This measure is the number of its adjacent edges.

The vertex with the fewest degree is $`r as.character(vertex_df$ego[Degree_min_stat_indiv])`$ (number: $`r  Degree_min_stat_indiv`$). This measure is the number of its adjacent edges.




## Network plots

```{r fig.cap=paste("Original social network plot with no alterations (Fruchterman-Reingold layout)")}
plot(graph_complete_simpl,
          layout = layout.fruchterman.reingold,
          #edge.color=edge_test$connection,
          edge.arrow.size=.1,
          #vertex.color=profession.colors,
          #vertex.size=((in.degree)*1.5),
          vertex.size=5,
          vertex.label=NA,
          vertex.label.cex=0.7,
          vertex.label.dist=1,
          vertex.label.degree=-0.6,
          #main="Network Plot",
          #frame=TRUE,
          margin=0.0001)

```

```{r fig.cap=paste("Original social network plot with no alterations (Nicely layout)")}
  plot(graph_complete_simpl,
       #edge.color=edge_test$connection,
       edge.arrow.size=.1,
       #vertex.color=profession.colors,
       #vertex.size=((in.degree)*1.5),
       vertex.size=5,
       vertex.label=NA,
       vertex.label.cex=0.7,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="Network Plot_Nicely",
       #frame=TRUE,
       margin=0.0001,
       layout = layout_nicely)
```

```{r fig.width=10, fig.height=10, fig.cap=paste("Social network plot with vertex colored based on profession (Nicely layout)")}
  plot(graph_complete_simpl,
       layout = layout.graph,
       rescale = F,
       #edge.color=edge_test$connection,
       edge.arrow.size=.1,
       vertex.color=profession.colors,
       #vertex.size=((in.degree)*1.5),
       vertex.size=5,
       vertex.label=NA,
       vertex.label.cex=0.5,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="SNA by Profession",
       #frame=TRUE,
       margin = 0.0001)
    legend(x=-1.1, y = -1.1, legend = levels(vertex_df$profession.df), 
         col = colr.palette, pch=19, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
```

```{r fig.width=10, fig.height=10, fig.cap=paste("Social network plot with vertex colored based on profession and vertices weighed by in-degree")}
  plot(graph_complete_symmetrized,
        #edge.color=edge_test$connection,
        edge.arrow.size=.5,
        vertex.color=profession.colors,
        vertex.size=in.degree*1.5,
        #vertex.label=vertex_df$profession.df,
        vertex.label=NA,
        vertex.label.cex=0.7,
        vertex.label.dist=1,
        vertex.label.degree=-0.6,
        #frame=TRUE,
        margin=0.0001)

   legend(x=-1.1, y = -1.1, unique(vertex_df$profession.df), pch=19,
          col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
```


```{r fig.width=10, fig.height=10, fig.cap=paste("Social network plot with vertex colored based on profession and vertices weighed by total degree")}
    plot(graph_complete_simpl,
       layout = layout.graph,
       rescale = F,
       #edge.color=edge_test$connection,
       edge.arrow.size=.1,
       vertex.color=vertex_df$profession.df,
       vertex.size=igraph::degree(graph_complete_simpl),
       vertex.label=NA,
       vertex.label.cex=0.5,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main="SNA Vertices Weighted by Degree",
       #frame=TRUE,
       margin = 0.0001)
  legend(x=-1.1, y = -1.1, unique(vertex_df$profession.df), pch=19,
         col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
```
  
```{r fig.width=10, fig.height=10, fig.cap=paste("Social network plot demonstrating how long vertices have worked with each other")}
  plot(graph_complete.years,
       layout=(layout.graph*1.1),
       rescale=F, 
       #edge.color=edge_test$connection,
       edge.arrow.size=.01,
       vertex.color=vertex_df$profession,
       #vertex.size=((in.degree)*0.9),
       vertex.size=3,
       #vertex.label=vertex_df$profession.df,
       vertex.label=NA,
       vertex.label.cex=0.6,
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main=paste0('Network of worked-together-with ',cut.off,' years connection'),
       #frame=TRUE,
       margin=0.0001)

  legend(x=-1.1, y = -1.1, unique(vertex_df$profession.df), pch=19,
         col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
```

```{r fig.width=10, fig.height=10, fig.cap=paste("Social network plot with vertices grouped by professions")}
   plot(graph_complete_symmetrized,
       layout=(LO*1.0),
       rescale=F, 
       #edge.color=edge_test$connection,
       edge.arrow.size=.5,
       vertex.color=vertex_df$profession.df,
       #vertex.size=((in.degree)*0.7),
       vertex.size=3,
       #vertex.label=vertex_df$profession.df,
       vertex.label=NA,
       vertex.label.cex=0.7,
       vertex.label.color= adjustcolor("black", 0.6),
       vertex.label.dist=1,
       vertex.label.degree=-0.6,
       #main='Test Data Connections (color by profession)',
       #frame=TRUE,
       margin=0.01)

  legend(x=-1.1, y = -1.1, unique(vertex_df$profession.df), pch=19,
         col= colr.palette, pt.cex=0.8, cex=0.8, bty="n", ncol=2)
```